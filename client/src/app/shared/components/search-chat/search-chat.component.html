<div class="search-container p-4">
  
  <!-- Search Input -->
  <div class="relative w-full mb-4">
    <mat-icon class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">search</mat-icon>
    <input 
      [formControl]="searchControl"
      type="text" 
      placeholder="Search chats..." 
      class="w-full bg-black/5 dark:bg-white/10 rounded-full py-3 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-[var(--mat-sys-on-surface)]"
      autoFocus
    >
  </div>

  <!-- Loading Skeleton -->
  <div *ngIf="isSearching$ | async" class="space-y-3 mt-2">
    <!-- Skeleton Item 1 -->
    <div class="flex flex-col gap-2 p-2 animate-pulse">
      <div class="h-4 bg-gray-300 dark:bg-gray-700 rounded w-3/4"></div>
      <div class="h-3 bg-gray-200 dark:bg-gray-800 rounded w-1/2"></div>
    </div>
    <!-- Skeleton Item 2 -->
    <div class="flex flex-col gap-2 p-2 animate-pulse">
      <div class="h-4 bg-gray-300 dark:bg-gray-700 rounded w-2/3"></div>
      <div class="h-3 bg-gray-200 dark:bg-gray-800 rounded w-1/3"></div>
    </div>
    <!-- Skeleton Item 3 -->
    <div class="flex flex-col gap-2 p-2 animate-pulse">
      <div class="h-4 bg-gray-300 dark:bg-gray-700 rounded w-4/5"></div>
      <div class="h-3 bg-gray-200 dark:bg-gray-800 rounded w-2/5"></div>
    </div>
  </div>

  <!-- Results List -->
  <mat-nav-list *ngIf="!(isSearching$ | async)">
    
    <!-- Results Loop -->
    <a *ngFor="let chat of searchResults$ | async" mat-list-item (click)="openChat(chat._id, $event)" class="cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 rounded-lg transition-colors flex justify-start !items-center gap-3">
      <mat-icon matListItemIcon class="!text-lg text-gray-400 chat-icon">chat</mat-icon>
      <p class="font-medium text-sm text-[var(--mat-sys-on-surface)]">{{ chat.title }}</p>
      <p class="text-xs text-gray-500 truncate">
        {{ chat.lastMessage || 'Click to view conversation' }}
      </p>
    </a>

    <!-- Empty State -->
    <div *ngIf="(searchResults$ | async)?.length === 0 && searchControl.value" class="text-center py-8 text-gray-500 text-sm">
      No chats found matching "{{ searchControl.value }}"
    </div>

  </mat-nav-list>
</div>